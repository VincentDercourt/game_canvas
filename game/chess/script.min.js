window.onload=function(){String.prototype.capitalize=function(){return this[0].toUpperCase()+this.slice(1)};const o=Math.pow(8,2),e="ABCDEFGH",t=document.querySelector("#chess"),l=t.getContext("2d");t.width=600,t.height=600;let c={},i=[],r=[],a="black";l.beginPath(),l.rect(0,0,600,600),l.fillStyle="#f0cc9c",l.fill(),l.beginPath(),l.strokeStyle="#604740",l.strokeRect(50,50,500,500),l.strokeRect(40,40,520,520);let n=0,f=8,v=!0;for(let t=0;t<o;t++){let o=t%8,r=e[o];"A"===r&&(n++,f--,v=!v);let a,h=62.5*o+50,d=62.5*f+50;v?(a="#f0cc9c",v=!1):(a="#604740",v=!0);let g=n;c[r+g]={x:h,y:d,color:a,active:!1};let s=1===g||2===g?"white":"black",x="";8===g||1===g?"A"===r||"H"===r?x="rook":"B"===r||"G"===r?x="knight":"C"===r||"F"===r?x="bishop":"D"===r?x="queen":"E"===r&&(x="king"):2!==g&&7!==g||(x="pawn"),x&&i.push({name:x,img:`${x+s.capitalize()}.png`,selected:`${x+s.capitalize()}Aura.png`,active:!1,box:r+g,color:s,dead:!1}),l.beginPath(),l.font="30px Comic Sans MS",l.fillStyle="#604740",l.textAlign="center",l.fillText(r,h+31.25,30),l.fillText(r,h+31.25,590),l.fillText(g,20,d+31.25),l.fillText(g,580,d+31.25)}function h(o,e){if(o)if("queen"===o.name)alert(`Les ${r.color} ont gagnÃ© !`),location.reload();else{let e=i.indexOf(o);i[e].box="",i[e].dead=!0,document.querySelector(`#${o.color}Dead`).innerHTML+=`<img src='${"chessPiece/"+o.img}' alt='${o.name}'>`}let t=i.indexOf(r);i[t].box=e,r=!1,a="white"===a?"black":"white",d(i[t])}function d(o){if(r=!1,a!==o.color){let t,l,a,n,f=o.box,v=f[0],h=e.indexOf(v),d=Number(f[1]);if(i[i.indexOf(o)].active=!0,"pawn"===o.name)a=h,l=d-1,"white"===o.color&&(l=d+1),l>0&&l<9&&(t=e[a]+l,n=g(t),n||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=g(t),n&&n.color!==o.color&&(c[t].active=!0)),h<7&&(a=h+1,t=e[a]+l,n=g(t),n&&n.color!==o.color&&(c[t].active=!0));else if("rook"===o.name){for(let e=d+1;e<=8&&(t=v+e,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e++);for(let e=d-1;e>0&&(t=v+e,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e--);for(let l=h+1;l<e.length&&(t=e[l]+d,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l++);for(let l=h-1;l>=0&&(t=e[l]+d,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l--);}else if("knight"===o.name)d<7&&(l=d+2,h<7&&(a=h+1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0))),d>2&&(l=d-2,h<7&&(a=h+1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0))),h<6&&(a=h+2,d<8&&(l=d+1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0)),d>1&&(l=d-1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0))),h>1&&(a=h-2,d<8&&(l=d+1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0)),d>1&&(l=d-1,t=e[a]+l,n=g(t),n&&n.color===o.color||(c[t].active=!0)));else if("bishop"===o.name){let i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=d+v,a=h+v,l<9&&a<8&&!r&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l<9&&a>-1&&!i&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=d-v,a=h+v,l>0&&a<8&&!r&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l>0&&a>-1&&!i&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}}else if("queen"===o.name){let i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=d+v,a=h+v,l<9&&a<8&&!r&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l<9&&a>-1&&!i&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=d-v,a=h+v,l>0&&a<8&&!r&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l>0&&a>-1&&!i&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}for(let e=d+1;e<=8&&(t=v+e,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e++);for(let e=d-1;e>0&&(t=v+e,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e--);for(let l=h+1;l<e.length&&(t=e[l]+d,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l++);for(let l=h-1;l>=0&&(t=e[l]+d,n=g(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l--);}else"king"===o.name&&(l=d+1,a=h+1,l<9&&a<8&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),a=h-1,l<9&&a>-1&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),l=d-1,a=h+1,l>0&&a<8&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),a=h-1,l>0&&a>-1&&(t=e[a]+l,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),d<8&&(t=v+(d+1),n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),d>1&&(t=v+(d-1),n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),h<7&&(t=e[h+1]+d,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),h>0&&(t=e[h-1]+d,n=g(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)));r=o}}function g(o){let e=!1;for(let t in i){let l=i[t];l.box!==o||l.dead||(e=l)}return e}function s(){for(let o in c){let e=c[o];u(e.x,e.y,e.color),e.active&&u(e.x,e.y,"rgba(117,160,255,0.41)")}}function x(){for(let o in c)c[o].active=!1;for(let o in i)i[o].active=!1}function u(o,e,t){l.beginPath(),l.rect(o,e,62.5,62.5),l.fillStyle=t,l.fill()}function b(){for(let o of i)if(!o.dead){let e=c[o.box];m("chessPiece/"+o[o.active?"selected":"img"],e.x,e.y)}}function m(o,e,t){let c=new Image(24,42);c.src=o,c.onload=()=>{l.beginPath(),l.drawImage(c,e+(62.5-c.width)/2,t+(62.5-c.height)/2,c.width,c.height)}}s(),b(),t.addEventListener("click",(function(o){let e=t.getBoundingClientRect();!function(o){for(let e in c){let t=c[e];if(t.x<=o.x&&t.x+62.5>o.x&&t.y<=o.y&&t.y+62.5>o.y){let o=g(e);t.active&&h(o,e),x(),o&&"object"==typeof o&&o.hasOwnProperty("dead")&&!o.dead&&d(o)}}}({x:Math.floor(o.clientX-e.left),y:Math.floor(o.clientY-e.top)}),l.beginPath(),l.rect(50,50,500,500),l.fill(),s(),b()})),console.log(c)};
//# sourceMappingURL=script.min.js.map